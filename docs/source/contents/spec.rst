.. include:: definition.txt

************************************************************************************************************************
プログラムの仕様
************************************************************************************************************************

========================================================================================================================
入力用 json ファイル
========================================================================================================================

建物の仕様やスケジュール等の使用方法を記述したプログラム入力用ファイルの仕様を記します。

------------------------------------------------------------------------------------------------------------------------
ルート
------------------------------------------------------------------------------------------------------------------------

ルート部分は次の要素で構成されています。

common
    | 空調方式などを記した common 要素です。必須項目です。
building
    | 建物全体に関する仕様を記した building 要素です。必須項目です。
rooms
    | 室の仕様を記した room 要素を配列で室の数だけ指定します。必須項目です。
boundaries
    | 外皮や室間の間仕切り等の境界の仕様を記した boundary 要素を配列で境界の数だけ指定します。必須項目です。
mechanical_ventilations
    | 換気経路の情報を記した mechanical_ventilation 要素を配列で換気経路の数だけ指定します。必須項目です。
    | なお、この機械換気には、通風利用による自然換気やレンジフード等の局所換気は含みません。
equipments
    | 設備の仕様を記した equipments 要素です。必須項目です。
    | equpments 要素はさらに暖房設備を記した heating_equipments 要素と、冷房設備を記した cooling_equipments 要素に分けられます。

.. code-block::
    :caption: root の記述例

    {
        "common": {...},
        "building": {...},
        "rooms": [
            {...},
            {...},
            ...
        ],
        "boundaries": [
            {...},
            {...},
            ...
        ],
        "mechanical_ventilations": [
            {...},
            {...},
            ...
        ],
        "equipments": {...}
    }

------------------------------------------------------------------------------------------------------------------------
common 要素
------------------------------------------------------------------------------------------------------------------------

common 要素は、唯一、以下の ac_method を持ちます。

ac_method
    | 空調の運転方式を表します。必須項目です。
    | 空調の運転方式として、指定されたPMVになるように空調する方法（PMV制御）と指定された作用温度になるように空調する方法（作用温度制御）の2種類が用意されています。
    | 空調の運転方式は文字列で指定します。
    | PMV 制御を指定する場合は、"pmv" とします。
    | 作用温度制御を指定する場合は、"simple" とします。

.. code-block::
    :caption: common 要素の記述例

    {
        "common": {
            "ac_method": "pmv"
        },
        ...
    }

------------------------------------------------------------------------------------------------------------------------
building 要素
------------------------------------------------------------------------------------------------------------------------

building 要素は、唯一、以下の infiltration 要素を持ちます。

infiltration
    | 漏気に関する設定を保持する infiltration 要素です。必須項目です。

.. code-block::
    :caption: building 要素の記述例

    {
        ...
        "building": {
            "infiltration": {...}
        },
        ...
    }

------------------------------------------------------------------------------------------------------------------------
infiltration 要素
------------------------------------------------------------------------------------------------------------------------

infiltration 要素は次の要素を持ちます。

method
    | 漏気量を計算する方法を選択します。必須項目です。
    | 建物の仕様から漏気量を計算する方法を指定します。
    | 現在、建物の仕様から漏気量を計算する方法は、 balance_residential メソッドのみです。
    | 文字列で、"balance_residential" と記します。
story
    | 建物の階数を表します。必須項目です。
    | 1 又は 2 を数値（整数型）で指定します。3 階以上の建物には対応していませんので、その場合は 2 と入力してください。
c_value_estimate
    | C値の指定方法を表します。必須項目です。specify と calculate が用意されています。
    | specify とは、C値を直接指定する方法です。
    | calculate とは、建物の構造とUA値からC値を推定する方法です。
c_value
    | 相当隙間面積を数値（小数点型）で表します。c_value_estimate 要素に specify が指定された場合のみ指定します。単位は |cm2| / |m2| です。0 以上の数字を入力します。
ua_value
    | UA値を数値（小数点型）で表します。c_value_estimate 要素に calculate が指定された場合のみ指定します。単位は W / ( |m2| K ) です。0 以上の数字を入力します。
struct
    | 建物の構造を表します。c_value_estimate 要素に calculate が指定された場合のみ指定します。
    | 文字列で、RC, SRC, WOODEN, STEEL から指定します。
    | RC は、鉄筋コンクリート造等を表します。
    | SRC は、鉄骨鉄筋コンクリート造を表します。
    | WOODEN は、木造を表します。
    | STEEL は、鉄骨造を表います。
    | これらの構造は、UA値とC値を紐づけるために指定する必要があります。
    | 鉄筋コンクリート造等と鉄骨鉄筋コンクリート造は結果は同じとなります。
    | 木造と鉄骨造は結果は同じとなります。
inside_pressure
    | 室内外の圧力差を入力します。必須項目です。 positive, negative, balanced から選択します。
    | positive とは室内圧力が室外圧力よりも高い状態を表します。換気方式として第2種換気を採用した場合には、positive を指定するのがよいでしょう。
    | negative とは室内圧力が室外圧力よりも低い状態を表します。換気方式として第3種換気を採用した場合には、negative を指定するのがよいでしょう。
    | balanced とは室内圧力と室外圧力が釣り合っている状態を表します。換気方式として第1種換気を採用した場合には、alanced を指定するのがよいでしょう。

.. code-block::
    :caption: infiltration 要素の記述例（C値を指定する場合）

    {
        ...
        "building": {
            "infiltration": {
                "method": "balance_residential",
                "story": 2,
                "c_value_estimate": "specify",
                "c_value": 2.3,
                "inside_pressure": "negative"
            }
        },
        ...
    }

.. code-block::
    :caption: infiltration 要素の記述例（C値をUA値や建物の構造から推定する場合）

    {
        ...
        "building": {
            "infiltration": {
                "method": "balance_residential",
                "story": "2",                
                "c_value_estimate": "calculate",
                "ua_value": 2.5,
                "struct": "RC",
                "inside_pressure": "negative"
            }
        },
        ...
    }

------------------------------------------------------------------------------------------------------------------------
room 要素
------------------------------------------------------------------------------------------------------------------------

room 要素は次の要素を持ちます。

id
    | 室の通し番号です。 必須項目です。
    | boundary 要素が接する室や、換気経路の指定、機器を設置する室の指定などに使用されます。
    | 重複した番号は指定できません。
    | 数値（整数型）です。
    | 通常は、0番から順番につけてください。
name
    | 室の名称です。必須項目です。
    | 文字列型で設定してください。
    | プログラムではエラー表示等のみに使用し、計算には使用しません。
sub_name
    | 室の副名称です。必須項目です。
    | 文字列型で設定してください。
    | 使用しない場合は空の文字列 "" を指定する等してください。
    | プログラムではエラー表示等のみに使用し、計算には使用しません。
floor_area
    | 床面積です。必須項目です。
    | 数値（小数点型）で指定してください。単位は、 |m2| です。
volume
    | 気積です。必須項目です。
    | 数値（小数点型）で制定してください。単位は、 |m3| です。
ventilation
    | 換気量に関する設定です。必須項目です。
    | 現在、自然換気を表す natural 要素のみを持ちます。
    | なお、局所換気量は別途 csv 等のスケジュールで指定します。
    | 局所換気以外の機械換気は、別途 mechanical_ventilations 要素で指定します。
furniture
    | 家具等の室内の備品に関する設定です。必須項目です。
    | furniture 要素を持ちます。
schedule
    | スケジュールに関する設定です。必須項目です。
    | schedule 要素を持ちます。

ventilation 要素は次の要素を持ちます。

natural
    | 自然風利用時の換気量です。単位は |m3| / s です。必須項目です。
    | 本プログラムは室内間の自然風利用時の換気による空気移動は考慮しておりません。
    | 常に、室と外気とで空気移動を考慮します。

furniture 要素は次の要素を持ちます。

input_method
    | 家具等の室内の備品の仕様の指定方法です。default と specify が用意されています。必須項目です。
    | default が指定された場合は、室の気積に基づいて自動的に設定されます。
    | specify が指定された場合は、自分で仕様を指定します。
heat_capacity
    | 備品等の熱容量です。imput_method に specify が指定された場合のみ指定します。単位は J / K です。
    | 数値（小数点型）で指定します。
heat_cond
    | 空気と備品等間の熱コンダクタンスです。imput_method に specify が指定された場合のみ指定します。単位は W / K です。
    | 数値（小数点型）で指定します。
moisture_capacity
    | 備品等の湿気容量です。imput_method に specify が指定された場合のみ指定します。単位は kg / ( kg / kg(DA) ) です。
    | 数値（小数点型）で指定します。
moisture_cond
    | 空気と備品等間の湿気コンダクタンスです。imput_method に specify が指定された場合のみ指定します。単位は kg / ( s ( kg / kg(DA)) ) です。
    | 数値（小数点型）で指定します。

schedule 要素は次の要素を持ちます。

name
    | 室で指定されるスケジュール名称です。必須項目です。
    | スケジュールは「平日」「休日在宅」「休日外出」ごと、居住者人数 1人・2人・3人・4人ごとに決められており、スケジュールjson ファイルとして定義されています。
    | スケジュール json ファイル内では複数のスケジュールが記述されています。
    | ここで指定する名称とスケジュール json ファイル内での名称とは一致しておく必要があります。

.. code-block::
    :caption: room 要素の記述例（家具等の備品を指定しない場合）

    {
        ...
        "rooms": [
            {
                "id": 0,
                "name": "living_room",
                "sub_name": "calc_pattern_0",
                "floor_area": 29.81,
                "volume": 70.92,
                "ventilation": {
                    "natural": 354.6
                },
                "furniture": {
                    "input_method": "default"
                },
                "schedule": {
                    "name": "main_occupant_room"
                }
            },
            ...
        ],
        ...
    }

.. code-block::
    :caption: room 要素の記述例（家具等の備品を指定する場合）

    {
        ...
        "rooms": [
            {
                "id": 0,
                "name": "living_room",
                "sub_name": "calc_pattern_0",
                "floor_area": 29.81,
                "volume": 70.92,
                "ventilation": {
                    "natural": 354.6
                },
                "furniture": {
                    "input_method": "specify",
                    "heat_capacity": 378000.0,
                    "heat_cond": 85.0,
                    "moisture_capacity": 500.0,
                    "moisture_cond": 0.9
                },
                "schedule": {
                    "name": "main_occupant_room"
                }
            },
            ...
        ],
        ...
    }

------------------------------------------------------------------------------------------------------------------------
boundary 要素
------------------------------------------------------------------------------------------------------------------------

boundary 要素は境界の仕様を表し、次の要素を持ちます。
なお、ここで境界と呼ぶのは、一般的な外皮（壁・屋根・外気床・階床・階壁）に加え、室と室（基礎断熱住宅の場合の床下空間も含む）との間の間仕切り壁・間仕切り床も含みます。

また、間仕切り壁の指定は、本プログラムでは少し特殊な設定となっています。
間仕切り壁の両側に位置する室をA、反対側の室をBとします。
本プログラムでは室Aから見た間仕切り壁と、室Bから見た間仕切り壁を別々に定義しないといけません。
間仕切り壁は実際の世界では1つだったとしても、本プログラムでは boudary 要素として室Aから見た情報と室Bから見た情報の2通りを指定しないといけません。
また、室Aから見た間仕切り壁と室Bから見た間仕切り壁は、見る方向が異なることで本来同じものですから、後述する層構成はちょうどリバースの関係になります。これも正しく入力する必要があります。

id
    | 境界の通し番号です。 必須項目です。
    | 境界が間仕切り壁の場合は、裏面の間仕切り壁番号を指定する場合に使用します。
    | 重複した番号は指定できません。
    | 数値（整数型）です。
    | 通常は、0番から順番につけてください。
name
    | 境界の名称です。必須項目です。
    | 文字列型で設定してください。
    | プログラムではエラー表示等のみに使用し、計算には使用しません。
sub_name
    | 境界の副名称です。必須項目です。
    | 文字列型で設定してください。
    | 使用しない場合は空の文字列 "" を指定する等してください。
    | プログラムではエラー表示等のみに使用し、計算には使用しません。
connected_room_id
    | 境界が接する室のIDです。必須項目です。
    | 別途 room 要素で定めた ID を指定します。room 要素に定めた ID 以外の値を指定するとエラーになります。
    | 数値（整数型）で指定します。
boundary_type
    | 境界の種類です。必須項目です。
    | "internal", "external_general_part", "external_transparent_part", "external_opaque_part", "ground" の中から1つを文字列で指定します。
    | "internal" とは、間仕切り壁のことです。
    | "external_general_part" とは、一般的な外皮のことを指し、開口部と地盤以外の外皮全般を指します。
    | "external_transparent_part" とは、透明な開口部を指します。一般的なガラス窓がこれに該当する他、大部分が透明な框ドアなどもこれにあたります。
    | "external_opaque_part" とは、非透明な開口部を指します。一般的に見られる透明ではないドアや、透明では無い板窓などがこれに該当します。
    | "ground" とは、地盤を指します。基礎断熱住宅や床断熱住宅における玄関や浴室下部など熱的境界が地盤と接する場合に指定します。なお、土間床周辺部の熱損失は別途指定します。
area
    | 境界の面積です。必須項目です。単位は |m2| です。数値（小数点型）で指定します。
is_sun_striked_outside
    | 外皮に日射があたるかどうかを指定します。
    | boundary_type が external_general_part, external_transparent_part, external_opaque_part の場合のみ指定します。
    | bool値で指定します。
    | true を指定した場合は、外皮の室外側表面に日射があたる設定となります。
temp_dif_coef
    | 温度差係数を表します。
    | boundary_type が external_general_part, external_transparent_part, external_opaque_part の場合のみ指定します。
    | 0.0から1.0までの間の数値（小数点型）で指定します。
    | 一般的に外気に接する場合は 1.0 を指定しますが、例えば、外気が床下空間、ピット、熱的に空調された空間などの場合は、例えば、0.0 や 0.7 等の数値が指定されます。
    | 外気の種類と指定する温度差係数の関係について詳しくは建築物省エネ法を参照してください。
rear_surface_boundary_id
    | 間仕切り壁の場合の裏面の境界のIDを指定します。
    | 数値（整数型）で指定します。
    | 詳しい設定の方法は後述します。
is_solar_absorbed_inside
    | 開口部等を通して入ってきた日射の大部分は家具等の備品により吸収され、残りは室内側の境界に吸収されます。
    | この項目は、室内に入ってきた日射が当該境界で吸収されるか否かを指定します。必須項目です。
    | bool値で指定します。
    | 1つの室に複数の境界でこの項目が true になった場合は、入ってきた日射はその境界の面積に応じて按分されます。
is_floor
    | 当該境界が床かどうかを表します。
    | bool値で指定します。必須項目です。
    | 在室者と境界表面との放射のやり取りを計算する際に必要な、在室者との形態係数を計算する時のみに使用されます。
    | 在室者は通常、室中央よりも床に近いところに居ることを考慮して、本プログラムでは床の形態係数を少し大きめに評価しています。その際の計算に使用されます。
direction
    | 境界の向く向きを表します。
    | is_sun_striked_outside が true の場合のみ、指定します。
    | "s", "sw", "w", "nw", "n", "ne", "e", "se", "top", "bottom" の中から文字列でしています。
    | "s", "sw", "w", "nw", "n", "ne", "e", "se" は、順に、南・南西・西・北西・北・北東・東・南東を表します。
    | "top" は上向き、"bottom" は下向きを表します。
    | 方位は8方位で指定することとしており、微妙な角度を指定することには対応していませんので、一番近い方位から選んでください。
    | また、水平方向または垂直方向に向いた外皮以外（例えば、傾斜屋根など）には対応していませんので、屋根の場合は "top"、壁の場合は方位から選ぶ等、近い向きを選んでください。
h_c
    | 室内側対流熱伝達率を表します。必須項目です。単位は W / ( |m2| K ) です。
    | 数値（小数点型）で指定します。
outside_emissivity
    | 室外側長波長放射率を表します。
    | boundary_type が external_general_part, external_transparent_part, external_opaque_part の場合のみ指定します。
    | 単位は無次元で、0.0から1.0の間の値を数値（小数点型）で指定します。
outside_heat_transfer_resistance
    | 室外側熱伝達抵抗を表します。
    | boundary_type が internal, external_general_part, external_transparent_part, external_opaque_part の場合のみ指定します。
    | 単位は、 |m2| K / W で、数値（小数点型）で指定します。
eta_value
    | 日射熱取得率を表します。
    | boundary_type が external_transparent_part の場合のみ指定します。
    | いわゆる、窓のη値であり、単位は無次元で、0.0から1.0の間の値を数値（小数点型）で指定します。
u_value
    | 熱貫流率を表します。
    | boundary_type が external_transparent_part, external_opaque_part の場合のみ指定します。
    | 単位は、 W / ( |m2| K ) で、数値（小数点型）で指定します。
    | 一般的に開口部は、製造者がJIS等で定められた方法によって熱貫流率を計測・計算するためにこの項目を設けています。
    | 開口部以外の一般的な壁などの場合は、別途、層構成なども考慮して、spec 要素で指定します。
inside_heat_transfer_resistance
    | 室内側熱伝達抵抗を表します。
    | boundary_type が external_transparent_part, external_opaque_part の場合のみ指定します。
    | 単位は、 |m2| K / W で、数値（小数点型）で指定します。
    | ここで指定する室内側熱伝達抵抗は、室内の空気や境界の表面間の熱バランスの計算には使いません。
    | 熱バランスの計算に使われる熱伝達率のうち、室内側表面の放射熱伝達率は室内側の境界の面積から形態係数を推定して決められます。
    | 室内側表面の対流熱伝達率は、別途定める値 "h_c" です。
    | ここで定める室内側熱伝達抵抗は、窓やドアのカタログ値（U値）から表面熱伝達抵抗を取り除いた実質部（室内側表面から室外側表面まで）の熱抵抗を推定するのに使用されます。
grass_area_ratio
    | 開口部の面積に対するグレージングの面積の比率です。
    | boundary_type が external_transparent_part の場合のみ指定します。
    | 単位は無次元で、0.0から1.0の数値（小数点型）で指定します。
incident_angle_characteristics
    | 一般的に窓に入射する太陽光の入射角特性は窓のガラス構成によって大きく異なります。
    | 本計算プログラムではガラスの透過・反射等の計算を単純化するために、「単層ガラス」と「複層ガラス」に類型化して計算方法を用意しています。
    | boundary_type が external_transparent_part の場合のみ指定します。
    | "simple", "multiple" のいずれかを指定します。
    | "simple" とは単層ガラスを指します。
    | "multiple" とは複層ガラスを指します。
outside_solar_absorption
    | 室外側日射吸収率を表します。
    | boundary_type が external_general_part, external_opaque_part の場合のみ指定します。
    | 透明な開口部における日射吸収率は別途指定するη値から推定されるため、ここでの指定は不要です。
    | 単位は無次元で、0.0から1.0の数値（小数点型）で指定します。
layers
    | 開口部を除く外皮および地盤を構成する層を表します。
    | layer 要素のリストです。必須項目です。
solar_shading_part
    | 日除けの仕様を指定するための solar_shading_part 要素です。必須項目です。










